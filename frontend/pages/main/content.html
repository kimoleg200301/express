<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: 'Arial', sans-serif; padding: 20px; background-color: #f8f9fa; }
    .container { width: 90%; max-width: 1200px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 15px rgba(0, 0, 0, 0.1); }
    #output, #loading-indicator { margin-top: 20px; padding: 10px; background-color: #f0f0f0; border-radius: 5px; min-height: 100px; white-space: pre-wrap; display: none; }
    input, button, select { width: 100%; padding: 10px; margin-top: 10px; }
    button { background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background-color: #0056b3; }
  </style>
  <title id="title_dynamic"></title>
</head>
<body>

  <div class="container">
    <h3 id="object_name"></h3>
    <p id="link_to_image"></p>
    <p id="rating"></p>
  </div>
  <div class="container">
    <h3>Описание</h3>
    <p id="description"></p>
  </div>
  <div class="container">
    <h3>Отзывы</h3>
    <div id="review"></div>
  </div>

</body>
<script>
  const params = new URLSearchParams(window.location.search);
  const id_content = params.get('id');

  const object_name_ = document.getElementById('object_name');
  const link_to_image_ = document.getElementById('link_to_image');
  const rating_ = document.getElementById('rating');
  const description_ = document.getElementById('description');
  const users_id_ = document.getElementById('users_id');
  const grade_ = document.getElementById('grade');
  const review_ = document.getElementById('review');
  const title_dynamic_ = document.getElementById('title_dynamic'); //title

  fetch(`http://localhost:3000/content?id=${id_content}`, {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json'
    },
    credentials: 'include'
  })
  .then(res => {
    if (!res.ok) { // Проверяем, успешен ли запрос
      throw new Error(`Ошибка ${res.status}: ${res.statusText}`);
    }
    return res.json();
  })
  .then(data => {
    if (data.message) {
      alert(data.message);
      return window.location.href = data.href_welcome;
    }
    else {
      /*Логи*/
      console.log(data.reviews);
      /*----*/
      document.title = `${data.object[0].object_name} | kiomessage`; // Назначение тайтла названием
      object_name_.textContent = data.object[0].object_name;
      link_to_image_.textContent = data.object[0].link_to_image;
      rating_.textContent = `Рейтинг: ${data.object[0].rating}/10`;
      description_.textContent = data.object[0].description;

      /*data.reviews.forEach(function (el, index) {
        review_.insertAdjacentHTML('beforeend', `
          <div id="user_id_${el.users_id}">
        `);
      });*/ //подумать как отображать отдельную запись данных клиентов

      
      /*users_id_.textContent = data.reviews.users_id;
      grade_.textContent = data.object.grade;
      review_.textContent = data.object.review;*/
    }
  })
  .catch(error => console.log(error, 'Ошибка со стороны клиента'));
</script>
</html>